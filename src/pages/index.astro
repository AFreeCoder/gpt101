---
import Layout from '~/layouts/PageLayout.astro';

import Hero from '~/components/widgets/Hero.astro';
import ServiceDetails from '~/components/widgets/ServiceDetails.astro';
import ToolsAndTutorials from '~/components/widgets/ToolsAndTutorials.astro';
import CustomerSupport from '~/components/widgets/CustomerSupport.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import PurchaseChannelModal from '~/components/widgets/PurchaseChannelModal.astro';

import { siteConfig } from '~/config/site';

const metadata = {
  title: 'ChatGPT 一站式 - ChatGPT Plus代充 & 镜像服务',
  description: 'ChatGPT Plus代充和ChatGPT镜像服务 - 安全快捷的ChatGPT服务提供商',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->
  <Hero
    compact
    tagline={`
      <div class="w-full mb-6 not-prose">
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-100 rounded-xl p-2">
          <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3 text-center sm:text-left">
              <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <div class="flex flex-col sm:flex-row items-center gap-2">
                <span class="text-gray-700 font-medium">无翻墙条件？</span>
                <span class="text-gray-600 font-medium">推荐稳定的镜像服务</span>
                <span class="text-blue-600 font-semibold">→ 国内直连，和官网完全一样，只需¥58/月</span>
              </div>
            </div>
            <div class="flex-shrink-0">
              <a href="/chatgpt-mirror" class="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium text-sm transition-all duration-300 shadow-sm hover:shadow-md">
                <span>了解镜像服务</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    `}
  >
    <Fragment slot="title">
      <!-- 大标题 -->
      <h1 class="text-8xl md:text-8xl font-bold mb-6">
        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"> ChatGPT Plus </span>
        <br />
        <span class="text-gray-800">充值服务</span>
      </h1>
    </Fragment>

    <Fragment slot="content">
      <div class="text-center max-w-4xl mx-auto">
        <!-- 打字机效果核心特点 -->
        <div class="mb-8">
          <div
            id="typewriter"
            class="text-2xl md:text-3xl font-semibold text-purple-600 min-h-[3rem] flex items-center justify-center"
          >
            <!-- 打字机内容将通过JavaScript动态插入 -->
          </div>
        </div>

        <!-- 副标题 -->
        <p class="text-lg text-gray-600 mb-8 max-w-3xl mx-auto leading-relaxed">
          专业 ChatGPT Plus 充值服务，无需海外信用卡，正规充值渠道，1分钟即可完成充值。<br />
          让每个人都能轻松订阅 ChatGPT Plus。
        </p>

        <!-- 三个按钮 -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-4">
          <a
            href={siteConfig.homepage.links.cardPurchase}
            target="_blank"
            class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white px-8 py-3 rounded-xl font-semibold transition-all duration-300 shadow-md"
          >
            {siteConfig.homepage.buttons.cardPurchase}
          </a>
          <div class="relative group">
            <button
              type="button"
              data-open-channel-modal
              class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-xl font-bold transition-all duration-300 shadow-lg"
            >
              {siteConfig.homepage.buttons.immediateUpgrade}
            </button>
            <!-- Tooltip -->
            <div
              class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-200 whitespace-nowrap z-50"
            >
              升级前请先购买卡密
              <div
                class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"
              >
              </div>
            </div>
          </div>
          <a
            href={siteConfig.homepage.links.orderQuery}
            class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-8 py-3 rounded-xl font-semibold transition-all duration-300"
          >
            {siteConfig.homepage.buttons.orderQuery}
          </a>
        </div>

        <!-- 服务保障 -->
        <div class="text-center mt-8">
          <div
            class="inline-flex items-center gap-3 bg-green-50 border border-green-200 rounded-xl px-6 py-4 shadow-sm"
          >
            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
              <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"></path>
              </svg>
            </div>
            <p class="text-green-800 font-semibold">服务保障：请放心购买，充值失败 100% 当天退款</p>
          </div>
        </div>
      </div>

      <!-- 打字机效果JavaScript -->
      <script>
        let typewriterTimer: ReturnType<typeof setTimeout> | null = null;

        const handlePageLoad = () => {
          const typewriterElement = document.getElementById('typewriter');
          if (!typewriterElement) {
            return;
          }

          cleanupTypewriter();
          typewriterElement.textContent = '';

          const texts = ['无需海外信用卡', '正规充值渠道', '1分钟完成充值', '不成功100%退款'];

          let currentTextIndex = 0;
          let currentCharIndex = 0;
          let isDeleting = false;

          function typeWriter() {
            if (!typewriterElement) return;
            const currentText = texts[currentTextIndex];

            if (isDeleting) {
              currentCharIndex = Math.max(currentCharIndex - 1, 0);
              typewriterElement.textContent = currentText.substring(0, currentCharIndex);

              if (currentCharIndex === 0) {
                isDeleting = false;
                currentTextIndex = (currentTextIndex + 1) % texts.length;
                typewriterTimer = setTimeout(typeWriter, 500); // 停顿500ms
                return;
              }
            } else {
              typewriterElement.textContent = currentText.substring(0, currentCharIndex + 1);
              currentCharIndex++;

              if (currentCharIndex === currentText.length) {
                typewriterTimer = setTimeout(() => {
                  isDeleting = true;
                  typeWriter();
                }, 2000); // 完整显示2秒
                return;
              }
            }

            typewriterTimer = setTimeout(typeWriter, isDeleting ? 50 : 100);
          }

          typeWriter();
        };

        function cleanupTypewriter() {
          if (typewriterTimer) {
            clearTimeout(typewriterTimer);
            typewriterTimer = null;
          }
        }

        const onBeforeSwap = () => {
          cleanupTypewriter();
          document.removeEventListener('astro:page-load', handlePageLoad);
          document.removeEventListener('astro:before-swap', onBeforeSwap);
        };

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', handlePageLoad, { once: true });
        } else {
          handlePageLoad();
        }

        document.addEventListener('astro:page-load', handlePageLoad);
        document.addEventListener('astro:before-swap', onBeforeSwap);
      </script>
    </Fragment>
  </Hero>

  <!-- Service Details Section ******************* -->
  <ServiceDetails id="service-details">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-gray-50 dark:bg-transparent"></div>
    </Fragment>
  </ServiceDetails>

  <!-- Tools and Tutorials Section ******************* -->
  <ToolsAndTutorials id="tools-tutorials">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-white dark:bg-transparent"></div>
    </Fragment>
  </ToolsAndTutorials>

  <!-- FAQs Widget ******************* -->
  <FAQs
    id="faqs"
    title="常见问题"
    subtitle="关于ChatGPT Plus代充和镜像服务的常见问题解答"
    tagline="FAQ"
    classes={{ container: 'max-w-6xl' }}
    items={[
      {
        title: 'Q: 代充服务安全吗？会不会影响我的账户？',
        description:
          '我们采用iOS正规代充技术，直接向官方账户充值，不留后门，完全安全。使用正规Apple账户充值通道，全自动化充值技术，确保账户安全和服务稳定。',
      },
      {
        title: 'Q: 充值失败怎么办？',
        description: '如果遇到充值失败的情况，请立即联系客服QQ：2316149029。',
      },
      {
        title: 'Q: 为什么价格和官方不一致？是正规服务吗？',
        description:
          '受渠道成本影响，价格偶尔会波动，请以最新充值价格为准。服务完全正规，充值后享受与官方相同的Plus功能和权限。',
      },
      {
        title: 'Q: 充值需要多长时间？',
        description:
          '我们提供24/7自动处理服务。购买卡密后，整个充值流程通常在1-3分钟内完成。极少数情况下可能需要10-20分钟。',
      },
      {
        title: 'Q: 支持哪些支付方式？',
        description: '我们支持微信支付，方便快捷。购买流程简单，支付完成后即可获得卡密，然后按照指引完成充值流程。',
      },
      {
        title: 'Q: 如何选择合适的服务？',
        description:
          '深度使用ChatGPT且有翻墙条件的用户建议选择Plus代充，享受完整功能；无翻墙条件或中度使用的用户可选择镜像服务，性价比更高。',
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-gray-50 dark:bg-transparent"></div>
    </Fragment>
  </FAQs>

  <!-- Customer Support Section ******************* -->
  <CustomerSupport id="customer-support">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-white dark:bg-transparent"></div>
    </Fragment>
  </CustomerSupport>

  <!-- Purchase Channel Modal ******************* -->
  <PurchaseChannelModal />
</Layout>
