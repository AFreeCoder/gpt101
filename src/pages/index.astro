---
import Layout from '~/layouts/PageLayout.astro';

import Hero from '~/components/widgets/Hero.astro';
import ServiceDetails from '~/components/widgets/ServiceDetails.astro';
import ToolsAndTutorials from '~/components/widgets/ToolsAndTutorials.astro';
import CustomerSupport from '~/components/widgets/CustomerSupport.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import PurchaseChannelModal from '~/components/widgets/PurchaseChannelModal.astro';

import { siteConfig } from '~/config/site';

const metadata = {
  title: 'ChatGPT 一站式 - ChatGPT Plus代充 & 镜像服务',
  description:
    'ChatGPT Plus代充服务 - 无需海外信用卡，正规iOS充值渠道，1分钟完成充值，失败100%退款。支持GPT-5 全部模型、GPTs商店、DALL-E 3等全功能，24/7自动处理，微信支付宝支付便捷安全',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->
  <Hero
    compact
    tagline={`
      <div class="w-full mb-6 not-prose">
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-100 rounded-xl p-2">
          <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3 text-center sm:text-left">
              <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <div class="flex flex-col sm:flex-row items-center gap-2">
                <span class="text-gray-700 font-medium">无翻墙条件？</span>
                <span class="text-gray-600 font-medium">推荐稳定的镜像服务</span>
                <span class="text-blue-600 font-semibold">→ 国内直连，和官网完全一样，只需¥58/月</span>
              </div>
            </div>
            <div class="flex-shrink-0">
              <a href="/chatgpt-mirror" class="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium text-sm transition-all duration-300 shadow-sm hover:shadow-md">
                <span>了解镜像服务</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    `}
  >
    <Fragment slot="title">
      <!-- 大标题 - Hero组件会自动包裹h1标签 -->
      <span class="text-8xl md:text-8xl font-bold mb-6 inline-block">
        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"> ChatGPT Plus </span>
        <br />
        <span class="text-gray-800">充值服务</span>
      </span>
    </Fragment>

    <Fragment slot="content">
      <div class="text-center max-w-4xl mx-auto">
        <!-- 打字机效果核心特点 -->
        <div class="mb-8">
          <div
            id="typewriter"
            class="text-2xl md:text-3xl font-semibold text-purple-600 min-h-[3rem] flex items-center justify-center"
          >
            <!-- 打字机内容将通过JavaScript动态插入 -->
          </div>
        </div>

        <!-- 核心卖点展示 -->
        <div class="mb-8">
          <div class="flex flex-wrap items-center justify-center gap-2 md:gap-3 max-w-3xl mx-auto">
            {
              siteConfig.homepage.features.map((feature, index) => {
                const colors = [
                  { bg: 'bg-green-50', border: 'border-green-200', icon: 'text-green-600' },
                  { bg: 'bg-blue-50', border: 'border-blue-200', icon: 'text-blue-600' },
                  { bg: 'bg-purple-50', border: 'border-purple-200', icon: 'text-purple-600' },
                  { bg: 'bg-orange-50', border: 'border-orange-200', icon: 'text-orange-600' },
                ];
                const color = colors[index % colors.length];
                return (
                  <div class={`flex items-center gap-1.5 px-2.5 py-1 ${color.bg} rounded border ${color.border}`}>
                    <svg class={`w-3 h-3 ${color.icon} flex-shrink-0`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="text-xs font-medium text-gray-700">{feature.text}</span>
                  </div>
                );
              })
            }
          </div>
        </div>

        <!-- 两个主按钮 -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-6">
          <!-- 主按钮1: 卡密购买 -->
          <a
            href={siteConfig.homepage.links.cardPurchase}
            target="_blank"
            class="w-full sm:w-auto bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white px-8 py-3 rounded-xl font-semibold transition-all duration-300 shadow-md hover:shadow-lg"
          >
            {siteConfig.homepage.buttons.cardPurchase}
          </a>

          <!-- 次主按钮2: 立即升级 -->
          <div class="w-full sm:w-auto bg-gradient-to-r from-blue-600 to-purple-600 p-[2px] rounded-xl shadow-md hover:shadow-lg transition-all duration-300">
            <button
              type="button"
              data-open-channel-modal
              class="group w-full bg-white hover:bg-gradient-to-r hover:from-blue-600 hover:to-purple-600 px-8 py-3 rounded-[10px] font-bold transition-all duration-300"
            >
              <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent group-hover:text-white transition-colors">
                {siteConfig.homepage.buttons.immediateUpgrade}
              </span>
            </button>
          </div>
        </div>

        <!-- 引导提示框 - 整合引导文案和订单查询 -->
        <div class="max-w-2xl mx-auto mb-4">
          <div class="bg-blue-50 border border-blue-200 rounded-lg px-6 py-4 text-center">
            <!-- 主提示文案 -->
            <div class="text-gray-700 mb-3">
              <span class="inline-flex items-center justify-center gap-2">
                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
                <span class="font-medium">
                  已完成购买？点击上方 <span class="text-blue-600 font-semibold">「{siteConfig.homepage.buttons.immediateUpgrade}」</span>
                </span>
              </span>
            </div>

            <!-- 辅助链接 -->
            <div class="flex items-center justify-center gap-3 text-sm">
              <a
                href={siteConfig.homepage.links.orderQuery}
                target="_blank"
                class="text-blue-600 hover:text-blue-700 font-medium hover:underline inline-flex items-center gap-1"
              >
                {siteConfig.homepage.buttons.orderQuery}
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
              <span class="text-gray-400">|</span>
              <a
                href={siteConfig.homepage.links.tutorial}
                class="text-blue-600 hover:text-blue-700 font-medium hover:underline inline-flex items-center gap-1"
              >
                {siteConfig.homepage.buttons.tutorial}
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>

        <!-- 服务保障 -->
        <div class="text-center mt-8">
          <div
            class="inline-flex items-center gap-3 bg-green-50 border border-green-200 rounded-xl px-6 py-4 shadow-sm"
          >
            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
              <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"></path>
              </svg>
            </div>
            <p class="text-green-800 font-semibold">服务保障：请放心购买，充值失败 100% 当天退款</p>
          </div>
        </div>
      </div>

      <!-- 打字机效果JavaScript -->
      <script>
        let typewriterTimer: ReturnType<typeof setTimeout> | null = null;

        const handlePageLoad = () => {
          const typewriterElement = document.getElementById('typewriter');
          if (!typewriterElement) {
            return;
          }

          cleanupTypewriter();
          typewriterElement.textContent = '';

          const texts = ['无需海外信用卡', '正规充值渠道', '1分钟完成充值', '不成功100%退款'];

          let currentTextIndex = 0;
          let currentCharIndex = 0;
          let isDeleting = false;

          function typeWriter() {
            if (!typewriterElement) return;
            const currentText = texts[currentTextIndex];

            if (isDeleting) {
              currentCharIndex = Math.max(currentCharIndex - 1, 0);
              typewriterElement.textContent = currentText.substring(0, currentCharIndex);

              if (currentCharIndex === 0) {
                isDeleting = false;
                currentTextIndex = (currentTextIndex + 1) % texts.length;
                typewriterTimer = setTimeout(typeWriter, 500); // 停顿500ms
                return;
              }
            } else {
              typewriterElement.textContent = currentText.substring(0, currentCharIndex + 1);
              currentCharIndex++;

              if (currentCharIndex === currentText.length) {
                typewriterTimer = setTimeout(() => {
                  isDeleting = true;
                  typeWriter();
                }, 2000); // 完整显示2秒
                return;
              }
            }

            typewriterTimer = setTimeout(typeWriter, isDeleting ? 50 : 100);
          }

          typeWriter();
        };

        function cleanupTypewriter() {
          if (typewriterTimer) {
            clearTimeout(typewriterTimer);
            typewriterTimer = null;
          }
        }

        const onBeforeSwap = () => {
          cleanupTypewriter();
          document.removeEventListener('astro:page-load', handlePageLoad);
          document.removeEventListener('astro:before-swap', onBeforeSwap);
        };

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', handlePageLoad);
        } else {
          handlePageLoad();
        }

        document.addEventListener('astro:page-load', handlePageLoad);
        document.addEventListener('astro:before-swap', onBeforeSwap);
      </script>
    </Fragment>
  </Hero>

  <!-- Service Details Section ******************* -->
  <ServiceDetails id="service-details">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-gray-50 dark:bg-transparent"></div>
    </Fragment>
  </ServiceDetails>

  <!-- Tools and Tutorials Section ******************* -->
  <ToolsAndTutorials id="tools-tutorials">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-white dark:bg-transparent"></div>
    </Fragment>
  </ToolsAndTutorials>

  <!-- FAQs Widget ******************* -->
  <FAQs
    id="faqs"
    title="常见问题"
    subtitle="关于ChatGPT Plus充值代充服务的常见问题解答"
    tagline="FAQ"
    classes={{ container: 'max-w-6xl' }}
    items={[
      {
        title: 'Q: 没有海外信用卡可以充值吗？',
        description:
          '完全可以！我们的服务专为国内用户设计，无需任何海外信用卡，使用支付宝或微信支付即可完成充值。采用正规iOS充值渠道，通过苹果官方订阅系统完成充值，安全便捷。',
      },
      {
        title: 'Q: 充值过程需要提供账号密码吗？',
        description:
          '不需要！整个充值流程无需提供ChatGPT账号密码，完全保护您的账户安全和隐私。您只需使用我们提供的充值卡密，按照简单步骤操作即可完成充值，全程不涉及账号密码信息。',
      },
      {
        title: 'Q: 充值需要多长时间？会很复杂吗？',
        description:
          '非常快速简单！购买卡密后，按照教程操作通常在1分钟内即可完成充值。我们提供详细的图文教程，即使是第一次操作也能轻松完成。24/7自动处理，随时购买随时充值。',
      },
      {
        title: 'Q: 如果充值失败会怎么样？',
        description:
          '请放心！如果遇到充值失败的情况，我们承诺100%当天退款，无需复杂流程。同时，我们已稳定运营2年，充值成功率极高。如有任何问题，联系客服QQ：2316149029，我们会第一时间处理。',
      },
      {
        title: 'Q: 充值后会不会被封号？如果封号怎么办？',
        description:
          '我们采用正规Apple官方充值渠道，与直接在ChatGPT官网订阅完全一致，不存在违规操作，正常使用不会被封号。万一因为充值问题导致封号（极少发生），我们提供封号退款保障，保护您的权益。',
      },
      {
        title: 'Q: 可以开发票吗？',
        description:
          '可以开具发票。如需发票，请在购买后联系客服QQ：2316149029，提供相关开票信息（公司名称、税号等），我们会为您办理发票开具事宜。',
      },
      {
        title: 'Q: 如何选择ChatGPT Plus充值还是镜像服务？',
        description:
          '深度使用ChatGPT且有网络条件的用户建议选择ChatGPT Plus充值服务，享受完整的官方功能；无网络条件或中度使用ChatGPT的用户可选择镜像服务，性价比更高，国内可直连使用，功能体验与官网一致。',
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-gray-50 dark:bg-transparent"></div>
    </Fragment>
  </FAQs>

  <!-- Customer Support Section ******************* -->
  <CustomerSupport id="customer-support">
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-white dark:bg-transparent"></div>
    </Fragment>
  </CustomerSupport>

  <!-- Purchase Channel Modal ******************* -->
  <PurchaseChannelModal />
</Layout>
