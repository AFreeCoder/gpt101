---
import { siteConfig } from '~/config/site';

const { ads } = siteConfig.homepage;

if (!ads) return null;

// Simple SVG Icons
const ClaudeIcon = `
<svg viewBox="0 0 128 128" class="w-10 h-10 text-white" fill="white" xmlns="http://www.w3.org/2000/svg">
  <path d="M37.5 118C28.2 114.7 20 109.8 13 103.5C23.5 107.5 35 110 47 110C83.5 110 113.5 83 118 48C124.5 54.5 128 63.5 128 73C128 103.4 103.4 128 73 128C59.7 128 47.5 124 37.5 118Z" fill="currentColor" fill-opacity="0.3"/>
  <path d="M64 0C28.7 0 0 28.7 0 64C0 81.3 6.9 97 18.2 108.6C12.7 96.6 9.8 83.2 10.9 69.1C13.2 41.6 34.6 18.7 61.9 14.8C90 10.8 116 32.5 116 61.2C116 61.8 116 62.4 116 63C123.5 54.8 128 43.9 128 32C128 14.3 113.7 0 96 0H64Z" fill="currentColor"/>
</svg>
`;

const ApiIcon = `
<svg viewBox="0 0 24 24" class="w-8 h-8 text-white" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
  <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
  <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
</svg>
`;

type AdConfig = (typeof ads)[keyof typeof ads];

const renderCard = (ad: AdConfig, side: 'left' | 'right') => {
  const isLeft = side === 'left';
  const lightBgClass = ad.color === 'orange' ? 'bg-orange-50' : 'bg-blue-50';
  const borderClass = ad.color === 'orange' ? 'border-orange-100' : 'border-blue-100';
  const buttonGradient = ad.color === 'orange' ? 'from-orange-400 to-orange-500' : 'from-blue-500 to-blue-600';
  const iconHtml = ad.icon === 'claude' ? ClaudeIcon : ApiIcon;
  const iconBg = ad.color === 'orange' ? 'bg-orange-400' : 'bg-blue-500';

  return `
    <div class="absolute ${isLeft ? 'left-4 lg:left-8' : 'right-4 lg:right-8'} top-1/2 -translate-y-1/2 z-40 w-[240px] transition-transform duration-300 hover:scale-105 hidden xl:block">
      <a 
        href="${ad.url}" 
        target="_blank" 
        rel="noopener noreferrer"
        class="block bg-white rounded-2xl shadow-xl overflow-hidden border ${borderClass}"
      >
        <!-- Top Gradient Line -->
        <div class="h-1.5 bg-gradient-to-r ${buttonGradient}"></div>

        <div class="p-4">
          <!-- Header -->
          <div class="flex items-center gap-3 mb-5">
            <div class="w-12 h-12 rounded-full ${iconBg} flex items-center justify-center text-white shadow-md">
              ${iconHtml}
            </div>
            <div class="flex-1">
              <h3 class="text-base font-bold text-gray-900 leading-tight">${ad.title}</h3>
              <div class="flex items-center gap-1.5 mt-0.5">
                <span class="relative flex h-2.5 w-2.5">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"></span>
                </span>
                <span class="text-xs text-green-700 font-medium">在线</span>
              </div>
            </div>
          </div>

          <!-- Description Box -->
          <div class="bg-gray-50 rounded-xl p-3 mb-4 relative group-hover:bg-gray-100 transition-colors min-h-[140px] flex items-center">
            <p class="text-sm text-gray-700 leading-relaxed font-medium">
               ${ad.description}
            </p>
          </div>

          <!-- Tags -->
          <div class="flex flex-wrap gap-2 mb-5">
            ${ad.tags
              .map(
                (tag: string) => `
              <span class="px-2.5 py-1 ${lightBgClass} ${ad.color === 'orange' ? 'text-orange-700' : 'text-blue-700'} rounded-full text-xs font-medium border ${ad.color === 'orange' ? 'border-orange-200' : 'border-blue-200'}">
                ✓ ${tag}
              </span>
            `
              )
              .join('')}
          </div>

          <!-- Button -->
          <div class="w-full bg-gradient-to-r ${buttonGradient} text-white py-3 rounded-xl font-bold text-center shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
            ${ad.buttonText}
          </div>

          <!-- Footer -->
          <div class="text-center mt-3 text-xs text-gray-600">
            ${ad.footerText}
          </div>
        </div>
      </a>
    </div>
  `;
};
---

<!-- 桌面端显示，平板/手机隐藏 -->
<Fragment set:html={renderCard(ads.left, 'left')} />
<Fragment set:html={renderCard(ads.right, 'right')} />
